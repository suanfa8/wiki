### 6.2 应用解耦

[[TOC]]

`场景：双11是购物狂节,用户下单后,订单系统需要通知库存系统,传统的做法就是订单系统调用库存系统的接口. `

![输入图片说明](https://images.gitee.com/uploads/images/2021/1027/193749_b845d2c2_426516.png "屏幕截图.png")

这种做法有一个缺点:

当库存系统出现故障时,订单就会失败。 订单系统和库存系统高耦合.  引入消息队列 

![输入图片说明](https://images.gitee.com/uploads/images/2021/1027/193723_672c3021_426516.png "屏幕截图.png")


- `订单系统:`用户下单后,订单系统完成持久化处理,将消息写入消息队列,返回用户订单下单成功。

- `库存系统:`订阅下单的消息,获取下单消息,进行库操作。  就算库存系统出现故障,消息队列也能保证消息的可靠投递,不会导致消息丢失.

